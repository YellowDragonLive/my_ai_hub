# 极客 AI 助手 (Geek AI Hub)

产品定位：一个高度自定义、支持多模型切换与 Prompt 管理的个人效率工具。

---

## 一、核心功能模块

### 1. 多源 API 聚合管理

**功能描述**：支持添加和管理多个大模型厂商的 API 配置。

**核心字段**：厂商名称、模型版本（如 gpt-4, claude-3）、API Key、自定义 Base URL（方便挂载代理）。

**交互逻辑**：
- 在设置页提供配置列表
- 对话框顶部显示当前模型，点击可快速弹出下拉框切换

---

### 2. 结构化 Prompt 库

**功能描述**：管理你的数百个技能（Skills）。

**数据结构**：每个项包含：标题、指令正文、分类标签、使用频率计数。

**交互逻辑**：
- 侧边栏或独立页面显示 Prompt 仓库
- 支持 "/" 快捷键触发：在对话框输入 `/` 即可弹出搜索框，快速置顶显示匹配的 Prompt
- 分级显示：支持按"工作"、"编程"、"生活"等标签过滤

---

### 3. 智能 Prompt 增强（AI 推荐）

**功能描述**：利用 AI 能力帮你写出更好的 Prompt。

**实现思路**：
- 预置一个"Prompt 优化专家"的底层指令
- 交互设计：在输入框旁边放一个"魔法棒"图标。点击后，将你当前简短的文字发给 AI，AI 返回优化后的版本供你确认或一键填充

---

### 4. 智能 Skill 生成（Pattern 自动创建）🆕

**功能描述**：当用户搜索 Skills 无精确匹配结果时，系统自动推荐相似 Pattern 并支持 AI 生成新 Skill。

#### 用户故事

```
作为一名内容创作者，
当我在对话框输入 "/" 搜索 Skills 时，
如果没有找到精确匹配的 Skill，
我希望系统能够：
1. 基于语义相似度，推荐最接近的 1-3 个现有 Patterns 作为参考
2. 提供一个"智能生成"按钮，让 AI 根据我的需求描述和参考 Pattern 的结构
3. 自动生成一个新的 Pattern（包含 system.md 和可选的 user.md）
4. 将生成的 Pattern 保存到本地 patterns 目录，并自动添加到 Skill 库
以便我下次遇到类似需求时可以直接复用。
```

#### 核心流程

```mermaid
flowchart TD
    A[用户输入搜索关键词] --> B{精确匹配?}
    B -->|是| C[显示匹配结果]
    B -->|否| D[触发智能推荐模式]
    D --> E[展示 1-3 个语义相近的 Pattern 卡片]
    E --> F[用户点击"智能生成 Skill"按钮]
    F --> G[AI 根据描述 + 参考结构生成 system.md]
    G --> H[用户预览、编辑、确认]
    H --> I[保存到 patterns/<skill-name>/system.md]
    I --> J[自动加载到技能库，无需重启]
```

#### 技术要点

| 模块 | 说明 |
|------|------|
| **语义匹配** | 使用 TF-IDF 或简单的关键词权重算法，匹配 Pattern 的标题和描述 |
| **Pattern 模板** | 预置标准的 system.md 结构模板，包含角色定义、任务目标、输出格式等区块 |
| **热加载** | 保存后自动刷新 patternLoader 缓存，新 Skill 即时可用 |

#### 验收条件

- [ ] 搜索无精确结果时，显示"未找到匹配，为您推荐相似 Skill"提示
- [ ] 推荐卡片可点击查看 Pattern 详情
- [ ] "智能生成"按钮可触发 AI 生成流程
- [ ] 生成的 Pattern 符合标准目录结构（`patterns/<name>/system.md`）
- [ ] 新 Pattern 保存后立即出现在 Skill 列表中

---

### 5. 全文搜索与会话管理

**功能描述**：打破"信息孤岛"，让历史记录可被利用。

**技术要求**：
- 本地数据库（如 SQLite 或 IndexedDB）存储会话
- 搜索维度：支持搜索会话标题、搜索聊天气泡里的具体文本

**交互逻辑**：
- 搜索框常驻在会话列表上方
- 搜索结果实时反馈，点击结果自动定位到该会话的对应时间轴

---

## 二、关键页面流程 (Flow)

**对话主流程**：
```
打开 App -> 选定模型 -> （可选）输入 "/" 调取 Skills -> 输入问题 -> 发送 -> 结果存入本地数据库
```

**Prompt 管理流程**：
```
进入仓库 -> 新增/编辑 -> 贴标签 -> 保存
```

**智能 Skill 生成流程**（🆕）：
```
输入 "/" 搜索 -> 无匹配 -> 查看推荐 -> 点击生成 -> AI 创建 -> 预览确认 -> 保存并加载
```

---

## 三、极简技术实现建议（供个人开发参考）

**数据存储**：
由于不考虑商业化和后端，建议直接使用客户端存储。如果是桌面端（如 Electron/Tauri），直接存 JSON 文件或 SQLite；如果是 Web 端，使用 IndexedDB。

**接口适配**：
建议定义一个标准的 "Adapter" 接口，将 OpenAI, Anthropic 等不同的数据格式统一化，这样你在切换模型时，前端 UI 逻辑不需要改动。

**搜索优化**：
如果会话量真的很大，可以考虑在本地实现简单的倒排索引，或者直接利用数据库的 LIKE 模糊查询。

**Pattern 热加载**（🆕）：
实现 patternLoader 的 `refresh()` 方法，在新 Pattern 保存后调用，避免重启应用。